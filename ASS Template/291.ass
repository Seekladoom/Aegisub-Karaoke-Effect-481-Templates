[Script Info]
; Script generated by Aegisub 2.1.8
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
PlayResX: 1280
PlayResY: 720
ScaledBorderAndShadow: yes
Video Aspect Ratio: 0
Video Zoom: 6
Video Position: 0
Last Style Storage: Default

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Engsub-furigana,UVN Ai Cap Nang,30,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,0.75,0,2,20,20,75,1
Style: Default-furigana,Arial,15,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,1.5,1.5,2,20,20,15,1
Style: Default,Arial,30,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,3,3,2,20,20,15,1
Style: Engsub,UVN Mua Thu,80,&H00FFFFFF,&H000000FF,&H00EAC600,&H00000000,-1,0,0,0,100,100,0,0,1,1,0,2,20,20,75,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Comment: 0,0:00:00.00,0:00:00.00,Karaoke,,0000,0000,0000,code syl all,function char_counter(ref) ci[ref] = ci[ref] + 1; return "" end ;
Comment: 0,0:00:00.00,0:00:00.00,Karaoke,,0000,0000,0000,code line all,ci = { 0,0 }; cn = _G.unicode.len(orgline.text_stripped:gsub(" ",""))
Comment: 0,0:00:00.00,0:00:00.00,Default,Get Scr Resolution,0000,0000,0000,code once,xres, yres = _G.aegisub.video_size() ratio = meta.res_y/720  if (xres and xres ~= meta.res_x) or (yres and yres ~= meta.res_y) then _G.aegisub.debug.out(2, "Warning: script resolution %dx%d does not match with loaded video resolution %dx%d resample script resolution(menu>subtitles>resample resolution>click from video)", meta.res_x, meta.res_y, xres, yres) end
Comment: 0,0:00:00.00,0:00:00.00,Default,Get Frame Dur,0000,0000,0000,code once,msa = _G.aegisub.ms_from_frame(1) msb = _G.aegisub.ms_from_frame(101) if msa == nil and msb == nil then _G.aegisub.debug.out(2, "Warning: Please load the video or use dummy video.Frame duration was provisionally set to 33 milliseconds. ") frame_dur = 33  else frame_dur = (msb-msa)/100 end
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,temp = {} function set_temp(ref,val) temp[ref] = val return val end
Comment: 0,0:00:00.00,0:00:00.00,Default,shape,0000,0000,0000,code once,shape = {"m 5 0 b 2 0 0 2 0 5 b 0 8 2 10 5 10 b 8 10 10 8 10 5 b 10 2 8 0 5 0"}
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,t = 0
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,function shape2() return string.format("{\\alpha&HFF&\\bord0\\blur8\\t(%d,%d,\\alpha&H00&\\3a&HA0&\\bord%d} m 30 23 b 24 23 24 33 30 33 b 36 33 37 23 30 23 m 35 27 l 61 28 l 35 29 m 26 27 l 0 28 l 26 29 m 29 23 l 30 0 l 31 23 m 29 33 l 30 57 l 31 33 {\\alpha&H00&\\t(%d,%d,\\alpha&HFF&} m -31 -23 b -38 -23 -38 -13 -31 -13 b -24 -13 -24 -23 -31 -23",100,101,1*ratio,100,101) end
Comment: 0,0:00:03.00,0:00:03.00,Default,Glitter Effects Function,0000,0000,0000,code once,function glitter(dur)  if (dur > 800) then tag =  string.format("\\t(%d,%d,\\fscx%d\\fscy%d)\\t(%d,%d,\\fscx%d\\fscy%d)\\t(%d,%d,\\fscx%d\\fscy%d)\\t(%d,%d,\\fscx%d\\fscy%d)",set_temp("time",math.random(800-800*t,dur)),temp.time+1,set_temp("size",math.random(50,100)*ratio),temp.size,temp.time+2,temp.time+100,25*ratio,25*ratio,temp.time+101,temp.time+102,set_temp("size",math.random(50,100)*ratio),temp.size,temp.time+103,temp.time+200,25*ratio,25*ratio) return tag else return "" end end
Comment: 0,0:00:00.00,0:00:00.00,Default,Vector Move Function,0000,0000,0000,code once,function Vector_Move(s_time,e_time,afterimage_dur,x_blur,y_blur,accel,base_pos_x,base_pos_y,max_space,scale_x,scale_y,s)  if (j == 1) then t = 0 pos_x = {} pos_y = {} if (afterimage_dur < 0 ) then afterimage_dur = 0 end c_point_x = {} c_point_y = {} point = {} i = 1 s:gsub("(%S+)", function(w) point[i] = w i = i + 1 end) dur = e_time-s_time i = 1 m = 0 max_x = -10000 min_x = 10000 max_y = -10000 min_y = 10000 scale_x = scale_x / 100 scale_y = scale_y / 100 while i <= #point do c_point_x = {} c_point_y = {} if point[i] == "m" then s_point_x = point[i+1] s_point_y = point[i+2] i = i + 3 elseif point[i] == "b" then c_point_x[1] = s_point_x*scale_x c_point_y[1] = s_point_y*scale_y for k = 2, 4, 1 do c_point_x[k] = point[i+1+(k-2)*2]*scale_x c_point_y[k] = point[i+2+(k-2)*2]*scale_y end max_x = math.max(max_x,_G.unpack(c_point_x)) max_y = math.max(max_y,_G.unpack(c_point_y)) min_x = math.min(min_x,_G.unpack(c_point_x)) min_y = math.min(min_y,_G.unpack(c_point_y)) c_point_x[1] = s_point_x*scale_x+base_pos_x c_point_y[1] = s_point_y*scale_y+base_pos_y for k = 2, 4, 1 do c_point_x[k] = point[i+1+(k-2)*2]*scale_x+base_pos_x c_point_y[k] = point[i+2+(k-2)*2]*scale_y+base_pos_y end s_point_x = point[i+5] s_point_y = point[i+6] i = i + 7 elseif point[i] == "l" then c_point_x[1] = s_point_x*scale_x c_point_y[1] = s_point_y*scale_y c_point_x[2] = point[i+1]*scale_x c_point_y[2] = point[i+2]*scale_y max_x = math.max(max_x,_G.unpack(c_point_x)) max_y = math.max(max_y,_G.unpack(c_point_y)) min_x = math.min(min_x,_G.unpack(c_point_x)) min_y = math.min(min_y,_G.unpack(c_point_y)) c_point_x[1] = s_point_x*scale_x+base_pos_x c_point_y[1] = s_point_y*scale_y+base_pos_y c_point_x[2] = point[i+1]*scale_x+base_pos_x c_point_y[2] = point[i+2]*scale_y+base_pos_y s_point_x = point[i+1] s_point_y = point[i+2] i = i + 3 else _G.aegisub.debug.out("Unknown drawing command. You can use only \"m\" , \"b\" , \"l\"^^;") i = #point+1 end    c_t = 0 n = #c_point_x if n ~= 0 then  while c_t <= 1 do m = m + 1  pos_x[m], pos_y[m] = Bezier(n,c_point_x,c_point_y,c_t)   n_x, n_y = Bezier(n,c_point_x,c_point_y,c_t+0.1) dist = math.sqrt(math.abs(n_x-pos_x[m])^2+math.abs(n_y-pos_y[m])^2) c_t = c_t + max_space/dist*0.1 end end end maxloop(m) end retime("presyl",s_time+dur*(t^accel),s_time+dur*((t+1/m)^accel)+afterimage_dur) t = t + 1/m adjust_x = -(max_x - min_x) / 2 - min_x adjust_y = -(max_y - min_y) / 2 - min_y  return  string.format("\\move(%f,%f,%f,%f,%f,%f)",pos_x[j],pos_y[j],pos_x[j]+x_blur,pos_y[j]+y_blur,afterimage_dur/2,afterimage_dur) end
Comment: 0,0:00:00.00,0:00:00.00,Default,Bezier Function,0000,0000,0000,code once,function Bezier(n,x,y,t) p_x = 0 p_y = 0 for i = 1, n, 1 do p_y = p_y + y[i] * set_temp("bern",bernstein(i-1,n-1,t)) p_x = p_x + x[i] * temp.bern  end return p_x, p_y end
Comment: 0,0:00:00.00,0:00:00.00,Default,Bezier Function,0000,0000,0000,code once,function bernstein(i,n,t) return (factk(n) / (factk(i)*factk(n-i))) * (t^i) * ((1-t)^(n-i)) end
Comment: 0,0:00:00.00,0:00:00.00,Default,Bezier Function,0000,0000,0000,code once,function factk(n) k = 1 if (n > 1) then for i = 2, n, 1 do k = k * i end end return k end
Comment: 0,0:00:37.93,0:00:37.93,Default,syl / char ratio,0000,0000,0000,code line all,cn = _G.unicode.len(orgline.text_stripped:gsub("","")) sc_ratio = #line.kara/cn
Comment: 0,0:00:00.00,0:00:00.00,Default,font ratio,0000,0000,0000,code line all,font_ratio = line.styleref.fontsize/40
Comment: 0,0:00:15.27,0:00:15.27,Engsub,lead-in,0000,0000,0000,template char noblank,!retime("start2syl",-500+syl.i*50,0)!{\an5\move(!$scenter+math.random(80,130)!,!$smiddle+math.random(-60,60)!,$scenter,$smiddle,0,200)\bord0\blur10\be10\frz!math.random(-720,720)!\alpha&HFF&\t(0,200,\alpha&0&\bord1\blur2\be0\frz0\3c&HEAC600&)}
Comment: 0,0:00:15.27,0:00:15.27,Engsub,hilight,0000,0000,0000,template,!retime("syl",0,1800-$dur)!{\an5\pos($scenter,$smiddle)\t(0,50,\c&HFFFFFF&\3c&HFFFFFF&\bord8\blur8)\t(50,$dur,\bord1\1a&HFF&\blur1\frz0)\fad(0,800)}
Comment: 0,0:00:00.00,0:00:00.00,Engsub,Flourish line,0000,0000,0000,template noblank notext,{!Vector_Move(-800,$sdur,$ldur+100-300*t,math.random(-25,25),math.random(-50,50),1.5,$scenter,$smiddle,3,300*ratio,300*ratio,"m 0 19 b 5 8 17 6 17 -5 b 18 -13 5 -21 0 -10 b -4 -21 -18 -13 -17 -5 b -17 6 -4 8 0 19 m -2 -9 b -2 -8 -3 -8 -3 -9 b -3 -10 -6 -13 -8 -12 b -9 -12 -9 -13 -8 -13 b -6 -14 -2 -11 -2 -9 m 15 -6 b 15 -5 14 -5 14 -6 b 13 -10 9 -12 6 -12 b 5 -12 5 -13 6 -13 b 10 -14 15 -10 15 -6 ")!\an5\fscx!30*ratio!\fscy!30*ratio!\1c&HFFFFFF&\3c&HEAC600&\shad0\bord!1*ratio!\blur!2*ratio!\t(\3c&HFFFFFF&)\fad(0,300)\fr45!glitter(line.duration)!\p1}!shape2()!
Comment: 0,0:00:00.00,0:00:02.00,Engsub,,0000,0000,0000,karaoke,{\k100}a
Comment: 0,0:00:02.00,0:00:04.00,Engsub,,0000,0000,0000,karaoke,
