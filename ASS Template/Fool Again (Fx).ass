[Script Info]
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
PlayResX: 640
PlayResY: 480
ScaledBorderAndShadow: yes
Video Aspect Ratio: 0
Video Zoom: 6
Video Position: 0

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,template syl noblank,!retime("syl",0,300)!{\an5\pos($center,$middle)\1a&HFF&\fscx0\fscy0\bord6\blur2\3c&HFFFFFF&\t(\fscx310\fscy310)\fad(0,300)\p1}m 16 11 b 16 0 0 0 0 11 b 0 22 16 22 16 11
Comment: 1,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,template char,{\an5}!char_counter2(1)!!retime("start2syl",-900+(ci2[1]-1)*35,0)!{\frz100\1a&HFF&\3a&HFF&\move(!$center+40!,!$middle+15!,$scenter,$smiddle,0,500)\t(0,500,\fscx100\fscy100\frz0\alpha&H00)}
Comment: 1,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,template noblank,!retime("syl",0,500)!{\r!math.random(-40,40)!\t(!set_temp("time",math.random(0,$dur+199))!,!temp.time+1!,\alpha&H00&)\t(\fr!math.random(40)!)\an5\pos($scenter,$smiddle)\t(0,100,\3c&HFFFFFF&\bord2.5\blur2\fscx130\fscy130\1c&HFF0A00&)\t(100,$dur,\3c!line.styleref.color3!\fscx100\fscy100\1a&HFF&)}
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code syl all,function char_counter2(ref) ci2[ref] = ci2[ref] + 1; return "" end
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code line all,ci2 = { 0 }; cn = _G.unicode.len(orgline.text_stripped:gsub(" ",""))
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code syl all,fxgroup.lastsyl = (syl.i == #line.kara)
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code syl all,fxgroup.nolastsyl = (not fxgroup.lastsyl)
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,math.randomseed(8317)
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,temp = {}
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once,function set_temp(ref,val) temp[ref] = val; return val; end
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once all,_fx_dur=1200 _fx_blur=10 _tails=2 _amplitude=30 _m_density=7 _s_density=30 _delay=20 _syl_factor=2.5 sparkle_shape="m 25 0 b 23 17 17 23 0 25 b 17 27 23 33 25 50 b 27 33 33 27 50 25 b 33 23 27 17 25 0"
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code once all,function magic_aura(center,middle,dur,leadout,tails,radius,density,delay,syl_factor) maxloop(tails*density) if(j<=1) then for x=1,tails,1 do set_temp(x*4,90+x*math.floor(360/tails)) set_temp(x*4+1,temp[x*4]+math.floor(dur/syl_factor)) set_temp(x*4+2,math.random(360)) set_temp(x*4+3,temp[x*4+2]+math.floor(dur/syl_factor)) end end iterate=math.floor(j/tails) retime("presyl",iterate*delay,iterate*delay+dur+leadout) tailn=j%3+1 tag=string.format("\\move(%d,%d,%d,%d,%d,%d)\\org(%d,%d)",center,middle-radius,center,middle-radius-10,dur,dur+leadout,center,middle) tag=tag..string.format("\\frx%d\\frz%d\\t(\\frx%d\\frz%d)",temp[tailn*4],temp[tailn*4+2],temp[tailn*4+1],temp[tailn*4+3]) resize_factor=40/density tag=tag..string.format("\\fscx%d\\fscy%d",100-iterate*resize_factor,200-2*iterate*resize_factor) return tag end
Comment: 0,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,code line all,shape="·" m_index=0 last_right=-1 function magic_trails(left,right,middle,t_offset,dur,fx_dur,fx_blur,tails,amplitude,m_density,s_density,delay,syl_factor) if (fx_dur==nil) then fx_dur=_fx_dur end if (fx_blur==nil) then fx_blur=_fx_blur end if (t_offset==nil) then t_offset=0 end if (tails==nil) then tails=_tails end if (amplitude==nil) then amplitude=_amplitude end if (m_density==nil) then m_density=_m_density end if (s_density==nil) then s_density=_s_density end if (delay==nil) then delay=_delay end if (syl_factor==nil) then syl_factor=_syl_factor end if (j==1) then m_index=m_index+1 end if (m_index>1) then left=last_right end if (j==loops) then last_right=right end loops=tails*m_density+math.floor(math.abs(right-left)*s_density/100) maxloop(loops) iterate=math.floor(j/tails) tag="\\an5\\fnArial" if (j<=tails*m_density) then shape="·" retime("presyl",iterate*delay+t_offset,iterate*delay+t_offset+dur) if (m_index==1) then for x=tails,tails*2,1 do temp[x]=90+(x%tails)*math.floor(360/tails) end end tag=tag..string.format("\\bord2\\be3\\move(%d,%d,%d,%d)\\org(%d,%d)",left,middle+amplitude,right,middle+amplitude,left,middle) tag=tag..string.format("\\frx%d",temp[m_index*tails+j%tails]) tag=tag..string.format("\\t(\\frx%d)",set_temp(m_index*tails+tails+j%tails,temp[m_index*tails+j%tails]+math.floor(dur/syl_factor))) resize_factor=40/m_density alpha_factor=60/m_density tag=tag..string.format("\\fscx0\\fscy0\\alpha%s",100-iterate*resize_factor,200-2*iterate*resize_factor,_G.ass_alpha((iterate-1)*alpha_factor)) end if (j>tails*m_density) then shape=sparkle_shape t=math.random(dur) retime("presyl",t+m_density*delay+t_offset,t+m_density*delay+fx_dur+t_offset) factor=t/dur x=left+math.floor((right-left)*factor) angle1=temp[m_index*tails+j%tails] angle2=temp[m_index*tails+j%tails]+math.floor(dur/syl_factor) d_y=math.floor(amplitude*math.cos((angle1+factor*(angle2-angle1))*3.1415/180)) y=middle+d_y fx_blur=math.abs(fx_blur) x2=x+math.random(-1*fx_blur,fx_blur) y2=y+math.random(-1*fx_blur,fx_blur) tag=tag..string.format("\\bord0\\be0\\move(%d,%d,%d,%d)\\fad(0,%d)\\p%d",x,y,x2,y2,math.floor(fx_dur*0.4),math.random(3,4)) blinks=math.ceil(fx_dur/100) for x=1,blinks,1 do tag=tag..string.format("\\t(%d,%d,\\fscx%d\\fscy%d)",x*100-100,x*100,set_temp("s_size",math.random(100)),temp.s_size) end end return tag end
Comment: 11,0:00:00.00,0:00:00.00,Default,,0000,0000,0000,template notext,{!magic_trails($left,$right,$middle,-250,500,_fx_dur,_fx_blur,_tails,20,10,40,5,1)!\fs18\c&HFFFFFF&\3c&HFFFFFF&}!shape!